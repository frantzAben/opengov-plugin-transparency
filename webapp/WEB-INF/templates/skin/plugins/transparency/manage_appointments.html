

<@row>
	<@columns>
		<@messages infos=infos />

    <h4>#i18n{transparency.manage_appointments.title}</h4>
	</@columns>
</@row>
<@row>
	<@columns>

            <@tform class="form-horizontal" method="post" name="form_search_appointment" action="jsp/site/Portal.jsp?page=appointment">
			<@messages errors=errors />
                        
			<@formGroup labelKey='#i18n{transparency.manage_appointments.searchByTitleLabel}' helpKey='#i18n{transparency.manage_appointments.searchByTitleLabel.help}' >
                            <@input type='text' name='search_title' id='search_title' value='' />
			</@formGroup>

                        <@formGroup labelKey='#i18n{transparency.manage_appointments.searchByPeriodLabel}' helpKey='#i18n{transparency.manage_appointments.searchByPeriodLabel.help}' >
                            <select id="search_period" name="search_period" class="form-control ">
                                <option value="-1">#i18n{transparency.manage_appointments.search_since_default}</option>
                                <option value="7" >#i18n{transparency.manage_appointments.search_since_last_week}</option>
                                <option value="31">#i18n{transparency.manage_appointments.search_since_last_month}</option>
                                <option value="92" selected=selected>#i18n{transparency.manage_appointments.search_since_last_3_months}</option>
                            </select>
                        </@formGroup>
                    
			<@formGroup labelKey='#i18n{transparency.manage_appointments.searchByElectedOfficialNameLabel}' helpKey='#i18n{transparency.manage_appointments.searchByElectedOfficialNameLabel.help}' >
                            <@input type='text' name='search_elected_official' id='search_elected_official' value='' />
			</@formGroup>
                        
                        <@formGroup labelKey='#i18n{transparency.manage_appointments.searchByLobbyNameLabel}' helpKey='#i18n{transparency.manage_appointments.searchByLobbyNameLabel.help}' >
                            <@input type='text' name='search_lobby' id='search_lobby' value=''  />
                        </@formGroup>	

                        <@formGroup>                        
                            <@button type="submit" name="action_searchAppointment" title="#i18n{portal.site.page_menu_tools.labelSearch}" buttonIcon="search" size="" />
                        </@formGroup>

            </@tform>
<#if is_authenticated  = true >
            <@tform action='jsp/site/Portal.jsp?page=appointment'>
                    <@button type='submit' name='view_createAppointment' class='pull-right' buttonIcon='plus' title='#i18n{transparency.manage_appointments.buttonAdd}' />
            </@tform>
</#if>

	</@columns>
</@row>
<@row>
	<@columns>
        <div class="directory-result-list">
    <@table>
        <tr>
            <th>#i18n{transparency.manage_appointments.columnTitle}</th>
            <th>#i18n{transparency.manage_appointments.columnStartDate}</th>
            <th>#i18n{transparency.manage_appointments.columnElectedOfficials}</th>
            <th>#i18n{transparency.manage_appointments.columnLobbies}</th>
            <th>#i18n{transparency.manage_appointments.columnContacts}</th>
<#if is_authenticated = true >
            <th>#i18n{portal.util.labelActions}</th>
</#if>
        </tr>
    <#list appointment_list as appointment >
        <tr>
            <td>
                <a href='jsp/site/Portal.jsp?page=appointment&view=detailAppointment&id=${appointment.id}' title='#i18n{transparency.detail_appointment.title}' >
                    ${appointment.title}
                </a>
                <br>
                ${appointment.description}

            </td>    
            <td>
		${appointment.startDate}
            </td>    
            <td>
                <#list appointment.electedOfficialList as electedOfficial>
                    ${electedOfficial.firstName} ${electedOfficial.lastName} <br>
                </#list>
            </td>    
            <td>
		<#list appointment.lobbyList as lobby>
                     <a href='jsp/site/Portal.jsp?page=lobby&view=detailLobby&id=${lobby.id}' title='#i18n{transparency.detail_lobby.title}' >
                        ${lobby.name} 
                    </a>

                    <br>
                </#list>
            </td>    
            <td>
		${appointment.contacts!''}
            </td>   
<#if is_authenticated  = true > 
            <td>
                <@aButton href='jsp/site/Portal.jsp?page=appointment&view=modifyAppointment&id=${appointment.id}' title='#i18n{portal.util.labelModify}' showTitle=false buttonIcon='pencil-square-o' />
                <@aButton href='jsp/site/Portal.jsp?page=appointment&action=confirmRemoveAppointment&id=${appointment.id}' title='#i18n{portal.util.labelDelete}' buttonIcon='trash' showTitle=false color='btn-danger' />
            </td>
</#if>

        </tr>
        </#list>
    </@table>
    </div>
	</@columns>
</@row>


<script src="js/jquery/jquery-ui.min.js"></script>  

<script  type="text/javascript" >
  $( function() {

    var getData = function (request, response) {
        $.getJSON(
            "${base_url}rest/transparency/api/v1/lobbies/search=" + request.term,
            function (data) {
                response(data);
            }
        );
    };

    $( "#search_lobby" ).autocomplete({
      source: getData,
      minLength: 3
    });
  } );
  </script>
  